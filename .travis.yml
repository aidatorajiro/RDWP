sudo: true
language: nix
script:
- reflex-platform/try-reflex
- nix-build -E '(import ./reflex-platform {}).ghcjs.callPackage ./. {}'
- sudo cp result/ghcjs/frontend/bin/RDWP-exe.jsexe/index.html result/ghcjs/frontend/bin/RDWP-exe.jsexe/404.html
deploy:
  provider: pages
  skip-cleanup: true
  local-dir: result/ghcjs/frontend/bin/RDWP-exe.jsexe
  github-token: $GITHUB_TOKEN
  on:
    branch: master
  repo: aidatorajiro/RDWP-dist
  target-branch: master
  keep-history: true
